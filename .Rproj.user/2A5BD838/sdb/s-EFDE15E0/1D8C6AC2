{
    "collab_server" : "",
    "contents" : "#install.packages(\"rsnps\")\n#source(\"https://bioconductor.org/biocLite.R\")\n#biocLite()\n#biocLite(\"org.Hs.eg.db\")\n# install.packages(\"HardyWeinberg\")\n# install.packages(\"powerGWASinteraction\")\n\nlibrary(rsnps)\n\nncbi_snp_query('rs4845140')\ngenotypes('rs4845140', userid='1,6,8', df=TRUE)\n\n\nlibrary(rentrez)\n\ngene_search = entrez_search(db   = \"gene\",\n                            term = \"IL10[Gene Name]) AND (Homo sapiens[Organism])\", retmax = 1)\ngeneId <- gene_search$ids \n\nsnp_links <- entrez_link(dbfrom='gene', id=geneId, db='snp')\n\n# access results with $links\nlength(snp_links$links$gene_snp)\n\nhead(snp_links$links$gene_snp)\n\nsnp_links$links$gene_snp # $gene_clinvar\n## with multi gene ids:\nmulti_snp_links <- entrez_link(dbfrom='gene', id=c(\"5728\", \"374654\"), db='snp', by_id=TRUE) # by_id = True makes the IDs grouped by ids.\nlapply(multi_snp_links, function(x) head(x$links$gene_snp))\n\n\n## \nsnp_search = entrez_search(db = 'snp',\n                           term = \"rs1800896[Reference SNP ID] OR rs1800871[Reference SNP ID] OR rs1800872[Reference SNP ID]\")\nsnp_search$count\nsnp_ids <- snp_search$ids\ngene_links <- entrez_link(dbfrom = 'snp', id =snp_ids, db = 'gene')\nsnpGene_ID <- gene_links$links$snp_gene\ngeneName <- entrez_search(db = 'gene', term = paste0(snpGene_ID, \"[uid]\"), \n                          rettype = 'gene_table')\n\ngeneName$ids\ngeneName$count\ngeneName$file\ngeneName$QueryTranslation\n\n### get gene symbol from Entrez Gene ID\nlibrary(org.Hs.eg.db)\nsnpGene_name = unlist(mget(x=snpGene_ID, envir=org.Hs.egGENENAME))\n\n### Power calculation\nlibrary(\"powerGWASinteraction\")\n\nn <- 1000\npower <- 0.95\nmodel <- list()\nmodel$prev <- 0.001\nmodel$pGene1 <- 0.05\nmodel$pGene2 <- 0.04\nmodel$nSNP <- 1000\nmodel$beta.LOR <- c(0.4, 0.3, 0.3)\nalpha1 <- 0.05\npowerGG(n = n, \n        #power = power,\n        model = model, alpha1 = alpha1)\n###",
    "created" : 1507686478070.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1235344489",
    "id" : "1D8C6AC2",
    "lastKnownWriteTime" : 1507694273,
    "last_content_update" : 1507694273320,
    "path" : "~/Documents/NGSProject/2017WGS/R/GeneGeneInteraction_HSCT/SNP_test.R",
    "project_path" : "SNP_test.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 4,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}